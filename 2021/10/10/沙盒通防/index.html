<!DOCTYPE html>


<html lang="zh">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>Sandbox universal defense |  H.greed</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="https://user-images.githubusercontent.com/72968793/136398013-abf88785-b056-4f51-aa15-a8ee261f5c7f.jpg" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-沙盒通防"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Sandbox universal defense
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/10/10/%E6%B2%99%E7%9B%92%E9%80%9A%E9%98%B2/" class="article-date">
  <time datetime="2021-10-10T08:43:03.000Z" itemprop="datePublished">2021-10-10</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">1k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">6 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="GitHub-address"><a href="#GitHub-address" class="headerlink" title="GitHub address"></a>GitHub address</h1><p><a target="_blank" rel="noopener" href="https://github.com/hexian2001/Sandbox-universal-defense">https://github.com/hexian2001/Sandbox-universal-defense</a></p>
<span id="more"></span>

<h1 id="Sandbox-universal-defense"><a href="#Sandbox-universal-defense" class="headerlink" title="Sandbox universal defense"></a>Sandbox universal defense</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sandbox general defense is a general defense project prepared for ctf-awd-pwn</span><br></pre></td></tr></table></figure>



<h1 id="Author"><a href="#Author" class="headerlink" title="Author"></a>Author</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SkYe231: https://www.mrskye.cn/</span><br><span class="line"></span><br><span class="line">H.greed(H.R.P): https://hgreed.vip/</span><br></pre></td></tr></table></figure>

<h1 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Based on the function of lief module, the normal binary program is started from_ The start function executes main and returns when main ends_ Start is the last real end.</span><br><span class="line">Our sandbox defense can be in .eh_frame section writes the sandbox assembly and the assembly code required to call the sandbox. In_ The place where start should have been written to the main function is changed to the address where the sandbox function is called, and the main function is called at the address where the sandbox function is called.</span><br><span class="line">The above not only ensures that the stack frame is not damaged and the program executes normally, but also disables function calls according to their own rules.</span><br></pre></td></tr></table></figure>

<h1 id="statement"><a href="#statement" class="headerlink" title="statement"></a>statement</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">All consequences arising from the use of the project shall be borne by the user. The project is only for learning and exchange because of the spirit of open source</span><br></pre></td></tr></table></figure>



<h1 id="Scope-of-application"><a href="#Scope-of-application" class="headerlink" title="Scope of application"></a>Scope of application</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">64 bit binary program under Ubuntu 18-Ubuntu 20 system</span><br></pre></td></tr></table></figure>



<h1 id="How-to-use"><a href="#How-to-use" class="headerlink" title="How to use?"></a>How to use?</h1><h2 id="Required-modules"><a href="#Required-modules" class="headerlink" title="Required modules"></a>Required modules</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install setuptools --upgrade</span><br><span class="line"></span><br><span class="line">sudo pip3 install lief</span><br></pre></td></tr></table></figure>

<h2 id="explains"><a href="#explains" class="headerlink" title="explains"></a>explains</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">We have prepared four demos under the demo file. One to three demos contain binaries before and after patch and corresponding attack scripts. Demo4 is a simple sandbox C file. In the sandbox folder, the sand.py file is the sink code of the corresponding 64 bit sandbox. Change.py is the PY file used to write sandbox protection. The sandbox. C file is converted from the 64 bit sandbox assembly code to bytecode, and then uses the pointer function to perform sandbox protection. The function of this file is to produce hook binary programs (we have prepared it for you)</span><br></pre></td></tr></table></figure>

<h2 id="how-to-make-your-hook-Binary-program"><a href="#how-to-make-your-hook-Binary-program" class="headerlink" title="how to make your hook Binary program"></a>how to make your hook Binary program</h2><p>Since you cannot rely on the libc library, you need to use the following command</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -nostdlib -nodefaultlibs -fPIC -Wl,-shared hook.c -o hook</span><br></pre></td></tr></table></figure>

<h2 id="how-use-change-py"><a href="#how-use-change-py" class="headerlink" title="how use change.py"></a>how use change.py</h2><p>example</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lief</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">patch_call</span>(<span class="params">file,srcaddr,dstaddr,arch = <span class="string">&quot;amd64&quot;</span></span>):</span></span><br><span class="line">	<span class="comment">#print hex(dstaddr)</span></span><br><span class="line">	length = p64((dstaddr - (srcaddr + <span class="number">5</span> )) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">	order = <span class="string">b&#x27;\xe8&#x27;</span>+length</span><br><span class="line">	<span class="comment">#print disasm(order,arch=arch)</span></span><br><span class="line">	file.patch_address(srcaddr,[<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>(order)])</span><br><span class="line"></span><br><span class="line">binary = lief.parse(<span class="string">&quot;./easypwn&quot;</span>)</span><br><span class="line">hook = lief.parse(<span class="string">&#x27;./hook&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># write hook&#x27;s .text content to binary&#x27;s .eh_frame content </span></span><br><span class="line">sec_ehrame = binary.get_section(<span class="string">&#x27;.eh_frame&#x27;</span>)</span><br><span class="line"><span class="comment">#print sec_ehrame.content</span></span><br><span class="line">sec_text = hook.get_section(<span class="string">&#x27;.rodata&#x27;</span>)</span><br><span class="line">sec_text1=hook.get_section(<span class="string">&#x27;.text&#x27;</span>)</span><br><span class="line"><span class="comment">#print sec_text.content</span></span><br><span class="line"><span class="built_in">list</span>=[<span class="number">0x90</span>]*<span class="number">10</span></span><br><span class="line">sec_ehrame.content = sec_text.content+sec_text1.content+<span class="built_in">list</span></span><br><span class="line"><span class="built_in">print</span>(sec_ehrame.content)</span><br><span class="line"><span class="comment">#print binary.get_section(&#x27;.eh_frame&#x27;).content</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hook target call</span></span><br><span class="line">dstaddr = sec_ehrame.virtual_address</span><br><span class="line">srcaddr = <span class="number">0x400870</span></span><br><span class="line"></span><br><span class="line">patch_call(binary,srcaddr,dstaddr)</span><br><span class="line"></span><br><span class="line">binary.write(<span class="string">&#x27;new2&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>about sec_ehrame.content you can use arry to add that contents what you need.such as this  python file u can add some nop.</p>
<p>For srcaddr variable , we chose. eh_ frame_ hdr The starting address of the paragraph, which ensures that the content is written to. eh_ frame paragraph.</p>
<h2 id="How-to-call-sandbox-reasonably-after-hook-is-written"><a href="#How-to-call-sandbox-reasonably-after-hook-is-written" class="headerlink" title="How to call sandbox reasonably after hook is written"></a>How to call sandbox reasonably after hook is written</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">We have prepared the basic calling program in the hook binary program. When using, we only need to change the address of the calling sandbox and call the main function. For the calling address of the calling sandbox function, we choose_ The start function is changed as follows</span><br></pre></td></tr></table></figure>

<h3 id="Sandbox-execution-and-call-sandbox"><a href="#Sandbox-execution-and-call-sandbox" class="headerlink" title="Sandbox execution and call sandbox"></a>Sandbox execution and call sandbox</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">.eh_frame:<span class="number">00000000004008</span>C0 loc_4008C0:                             ; DATA XREF: .eh_frame:<span class="number">00000000004009B</span>3↓o</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>C0                 push    rbp</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>C1                 mov     rbp, rsp</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>C4                 mov     r15, <span class="number">6</span></span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>CB                 push    r15</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>CD                 mov     r15, <span class="number">7F</span>FF000000000006h</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>D7                 push    r15</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>D9                 mov     r15, <span class="number">3B</span>00010015h</span><br><span class="line">.eh_frame:<span class="number">00000000004008E3</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">00000000004008E5</span>                 mov     r15, <span class="number">3800020015</span>h</span><br><span class="line">.eh_frame:<span class="number">00000000004008</span>EF                 push    r15</span><br><span class="line">.eh_frame:<span class="number">00000000004008F</span>1                 mov     r15, <span class="number">3200030015</span>h</span><br><span class="line">.eh_frame:<span class="number">00000000004008F</span>B                 push    r15</span><br><span class="line">.eh_frame:<span class="number">00000000004008F</span>D                 mov     r15, <span class="number">3100040015</span>h</span><br><span class="line">.eh_frame:<span class="number">0000000000400907</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400909</span>                 mov     r15, <span class="number">2</span>A00050015h</span><br><span class="line">.eh_frame:<span class="number">0000000000400913</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400915</span>                 mov     r15, <span class="number">2900060015</span>h</span><br><span class="line">.eh_frame:<span class="number">000000000040091F</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400921</span>                 mov     r15, <span class="number">4000000000070035</span>h</span><br><span class="line">.eh_frame:<span class="number">000000000040092B</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">000000000040092</span>D                 mov     r15, <span class="number">20</span>h ; <span class="string">&#x27; &#x27;</span></span><br><span class="line">.eh_frame:<span class="number">0000000000400934</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400936</span>                 mov     r15, <span class="number">0</span>C000003E09000015h</span><br><span class="line">.eh_frame:<span class="number">0000000000400940</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400942</span>                 mov     r15, <span class="number">400000020</span>h</span><br><span class="line">.eh_frame:<span class="number">000000000040094</span>C                 push    r15</span><br><span class="line">.eh_frame:<span class="number">000000000040094</span>E                 mov     r15, rsp</span><br><span class="line">.eh_frame:<span class="number">0000000000400951</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400953</span>                 mov     r15, <span class="number">0</span>Ch</span><br><span class="line">.eh_frame:<span class="number">000000000040095</span>A                 push    r15</span><br><span class="line">.eh_frame:<span class="number">000000000040095</span>C                 mov     r15, rsp</span><br><span class="line">.eh_frame:<span class="number">000000000040095F</span>                 push    r15</span><br><span class="line">.eh_frame:<span class="number">0000000000400961</span>                 mov     rdi, <span class="number">26</span>h ; <span class="string">&#x27;&amp;&#x27;</span></span><br><span class="line">.eh_frame:<span class="number">0000000000400968</span>                 mov     rsi, <span class="number">1</span></span><br><span class="line">.eh_frame:<span class="number">000000000040096F</span>                 mov     rdx, <span class="number">0</span></span><br><span class="line">.eh_frame:<span class="number">0000000000400976</span>                 mov     rcx, <span class="number">0</span></span><br><span class="line">.eh_frame:<span class="number">000000000040097</span>D                 mov     r8, <span class="number">0</span></span><br><span class="line">.eh_frame:<span class="number">0000000000400984</span>                 mov     rax, <span class="number">9</span>Dh</span><br><span class="line">.eh_frame:<span class="number">000000000040098B</span>                 syscall                 ; LINUX - sys_prctl</span><br><span class="line">.eh_frame:<span class="number">000000000040098</span>D                 mov     rdi, <span class="number">16</span>h</span><br><span class="line">.eh_frame:<span class="number">0000000000400994</span>                 mov     rsi, <span class="number">2</span></span><br><span class="line">.eh_frame:<span class="number">000000000040099B</span>                 mov     rdx, r15</span><br><span class="line">.eh_frame:<span class="number">000000000040099</span>E                 mov     rax, <span class="number">9</span>Dh</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>A5                 syscall                 ; LINUX - sys_prctl</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>A7                 leave</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>A8                 retn</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>A8 ; ---------------------------------------------------------------------------</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>A9                 db  <span class="number">0</span>Ah</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AA                 db    <span class="number">0</span></span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AB ; ---------------------------------------------------------------------------</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AB</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AB ; <span class="function"><span class="keyword">int</span> __fastcall <span class="title">loc_4009AB</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">char</span> **, <span class="keyword">char</span> **)</span></span></span><br><span class="line"><span class="function">.eh_frame:00000000004009AB loc_4009AB:                             </span>; DATA XREF: _start+<span class="number">1</span>D↑o</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AB                 push    rbp</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AC                 mov     rbp, rsp</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>AF                 sub     rsp, <span class="number">10</span>h</span><br><span class="line">.eh_frame:<span class="number">00000000004009B</span>3                 lea     rax, loc_4008C0</span><br><span class="line">.eh_frame:<span class="number">00000000004009B</span>A                 mov     [rbp<span class="number">-8</span>], rax</span><br><span class="line">.eh_frame:<span class="number">00000000004009B</span>E                 mov     rax, [rbp<span class="number">-8</span>]</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>C2                 mov     [rbp<span class="number">-10</span>h], rax</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>C6                 mov     rax, [rbp<span class="number">-10</span>h]</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>CA                 call    rax</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>CC                 nop</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>CD                 nop</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>CE                 call    main</span><br><span class="line">.eh_frame:<span class="number">00000000004009</span>D3                 retn</span><br></pre></td></tr></table></figure>

<p>about _start function</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">04005E0</span></span><br><span class="line">.text:<span class="number">00000000004005E0</span>                 <span class="keyword">public</span> _start</span><br><span class="line">.text:<span class="number">00000000004005E0</span> _start          proc near               ; DATA XREF: LOAD:<span class="number">0000000000400018</span>↑o</span><br><span class="line">.text:<span class="number">00000000004005E0</span>                 <span class="keyword">xor</span>     ebp, ebp</span><br><span class="line">.text:<span class="number">00000000004005E2</span>                 mov     r9, rdx         ; rtld_fini</span><br><span class="line">.text:<span class="number">00000000004005E5</span>                 pop     rsi             ; argc</span><br><span class="line">.text:<span class="number">00000000004005E6</span>                 mov     rdx, rsp        ; ubp_av</span><br><span class="line">.text:<span class="number">00000000004005E9</span>                 <span class="keyword">and</span>     rsp, <span class="number">0F</span>FFFFFFFFFFFFFF0h</span><br><span class="line">.text:<span class="number">00000000004005</span>ED                 push    rax</span><br><span class="line">.text:<span class="number">00000000004005</span>EE                 push    rsp             ; stack_end</span><br><span class="line">.text:<span class="number">00000000004005</span>EF                 mov     r8, offset __libc_csu_fini ; fini</span><br><span class="line">.text:<span class="number">00000000004005F</span>6                 mov     rcx, offset __libc_csu_init ; init</span><br><span class="line">.text:<span class="number">00000000004005F</span>D                 mov     rdi, offset loc_4009AB ; main</span><br><span class="line">.text:<span class="number">0000000000400604</span>                 call    cs:__libc_start_main_ptr</span><br><span class="line">.text:<span class="number">000000000040060</span>A                 hlt</span><br><span class="line">.text:<span class="number">000000000040060</span>A _start          endp</span><br></pre></td></tr></table></figure>

<p>This is where we need to modify</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004005F</span>D                 mov     rdi, offset loc_4009AB ; main</span><br></pre></td></tr></table></figure>



<p>For more details, please refer to the lief module. This project is only a derivative of this module</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyright： </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://hgreed.vip/2021/10/10/%E6%B2%99%E7%9B%92%E9%80%9A%E9%98%B2/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2021/10/13/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF2021/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            广东省强网杯2021
          
        </div>
      </a>
    
    
      <a href="/2021/10/10/vmpwn%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">vmpwn入门学习</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "",
    app_key: "",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2021
        <i class="ri-heart-fill heart_icon"></i> H.greed
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="https://user-images.githubusercontent.com/72968793/136398013-abf88785-b056-4f51-aa15-a8ee261f5c7f.jpg" alt="H.greed"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://jue-xian.gitee.io/">老博客1</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://jue-xian.gitee.io/diazang">老博客2</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.mrskye.cn/">skye231</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://blackwatch219.github.io/">Blackwatch</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://zoeyctf.top">zoey</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://eeknight.top">eeknight</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.mrzry.top">mrzry</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://h3h3qaq.github.io/">H3h3QAQ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->
 
<script src="/js/clickLove.js"></script>
 
<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="86"
        src="//music.163.com/outchain/player?type=2&id=1878868202&auto=0&height=66"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
</body>

</html>